Firebase Firestore Schemas for Kochi Metro App (Revised)
This document outlines the revised data model for the Kochi Metro decision-support platform, structured for use with Firebase Firestore. It removes sub-collections and organizes all private data under a top-level users collection.

1. users Collection
This top-level collection stores user-specific data and acts as the parent for all private user-related collections.

Collection Path: /artifacts/{appId}/users

Document ID: The user's unique ID (uid).

Document Fields:

lastLogin (Timestamp)

createdAt (Timestamp)

role (String, e.g., 'Supervisor', 'Admin')

2. trainsets Collection
This is a private, user-specific collection for all trainset information. Each document represents a single trainset.

Collection Path: /artifacts/{appId}/users/{userId}/trainsets

Document ID: A unique string, such as the trainsetId (e.g., 'TS01').

Document Fields:

trainsetId (String)

fleetNumber (Number)

currentStatus (String: 'Revenue Service', 'Standby', 'Inspection Bay Line')

lastUpdated (Timestamp)

lastRevenueServiceDate (Timestamp)

stablingPosition (String): A reference to a document in the stabling_bays collection.

notes (String)

3. health_and_maintenance Collection
This is now a top-level private collection with a flattened structure. Each document includes fields for all categories, with unused fields set to null or left out.

Collection Path: /artifacts/{appId}/users/{userId}/health_and_maintenance

Document ID: Auto-generated by Firestore.

Document Fields:

trainsetId (String): The ID of the trainset this record belongs to.

category (String: 'Fitness Certificate', 'Job Card', 'Mileage')

department (String): null if not a Fitness Certificate record.

validityWindowStart (Timestamp): null if not a Fitness Certificate record.

validityWindowEnd (Timestamp): null if not a Fitness Certificate record.

isClear (Boolean): null if not a Fitness Certificate record.

jobCardId (String): null if not a Job Card record.

status (String): null if not a Job Card record.

description (String): null if not a Job Card record.

completionDate (Timestamp): null if not a Job Card record.

value (Number): null if not a Mileage record.

lastRecordedDate (Timestamp): null if not a Mileage record.

4. branding_priorities Collection
This collection remains public, as branding data may be shared across the organization.

Collection Path: /artifacts/{appId}/public/data/branding_priorities

Document ID: Auto-generated by Firestore.

Document Fields:

trainsetId (String)

advertiser (String)

contractId (String)

contractualHoursRequired (Number)

hoursExposedToDate (Number)

startDate (Timestamp)

endDate (Timestamp)

5. stabling_bays Collection
This collection is now a private, user-specific collection.

Collection Path: /artifacts/{appId}/users/{userId}/stabling_bays

Document ID: A unique string, such as the bayId (e.g., 'Bay01').

Document Fields:

bayId (String)

trainsetId (String): Can be null if the bay is empty.

bayType (String: 'Revenue', 'Standby', 'IBL')

isClean (Boolean)

lastUsedDate (Timestamp)

6. cleaning_slots Collection
This collection is now a private, user-specific collection.

Collection Path: /artifacts/{appId}/users/{userId}/cleaning_slots

Document ID: Auto-generated by Firestore.

Document Fields:

slotId (String)

startTime (Timestamp)

endTime (Timestamp)

isOccupied (Boolean)

trainsetId (String): Can be null if the slot is available.

manpowerAllocated (Number)

type (String: 'Deep Clean', 'Interior Detailing')